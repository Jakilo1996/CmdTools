# 工具封装的思路

### 设计需求
- 解决自动化过程中的用例读写问题，提供常见的筛选、替换数据功能
- 实现一种工具，能够处理excel的常见需求
  - 核心解决的问题，是将excel文件读出来，并按照python合理的数据格式输出
  - 解决常见的用例筛选工作
    - 提供一个筛选条件，能够筛选出指定条件的用例
  - 能够进行用例数据统计功能
    - 能够按sheet页进行统计
    - 能够按不同文件进行统计
    - 统计常用的数据
      - excel的sheet页以及对应页的数据的数量
      - 当前筛选条件下的数据数量
  - 文件复制功能
    - 将文件以一定的条件复制到另一目录下
- 能够兼容多种数据类型的互相转换
  - 能够实现多种数据类型读取为标准的python数据类型
- 编写一个统一的命令行使用工具
  - 仅需输入一个版本参数就可以不用考虑命名影响
  - 标记一个参数，可以展示整体执行时间以及内部方法的执行时间
    - 能够展示工具执行时间细节
- 提供能自定义的变量操作
  - 将某一列某种特殊字符开头的数据渲染为另一种另一种自定义的数据类型
    - 举例
      - '$host' : 127.0.0.1
      - '!api_prefix': apisdp
#### 指标
- 编写代码全程必须按照python标准写法
- 编写尽可能详细的注释 以及参数说明
- 需要能够同时兼容框架工具内运行需求，又提供命令行模式供外部运行
- 调试的命令要尽量少
- 命令行参数要尽量短

#### 设计思路
- 分别将Excel、Json、Yaml、TxT文件的操作进行封装
  - excel读写操作封装在同一个类中，封装常用的操作
    - 所有数据的读操作
      - 为了提升性能，如果是有筛选的读，筛选操作要在第一步进行，而不是所有时候都去读所有
    - 类中定义常用的excel属性
      - 需要那个属性 就通过一个方法去拿，不能读所有
    - 替换操作
      - 也要尽量早进行，可以用一个参数标记是否需要替换，传入一个类，如果带标记的属性属于类，那么将其进行替换
      - 可以标记那一列需要进行替换
        - 一般是url列、参数列
        - 用$标记 测试开始前替换
        - 用@标记 初始化fixture执行后替换
- 将所有excel支持的方法，都封装在一个excel主函数中
- 封装一个可以进行所有操作的主函数
  - 数据类型转换操作，封装在主函数中
- 封装成命令工具

#### 扩展
- 之后兼容其他数据的常用操作